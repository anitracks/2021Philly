\hypertarget{cleanPlaintiffs_8py}{}\doxysection{C\+:/\+Users/\+SMcneil-\/\+Consultant/\+CLSM/2021\+Philly/src/clean\+Plaintiffs.py File Reference}
\label{cleanPlaintiffs_8py}\index{C:/Users/SMcneil-\/Consultant/CLSM/2021Philly/src/cleanPlaintiffs.py@{C:/Users/SMcneil-\/Consultant/CLSM/2021Philly/src/cleanPlaintiffs.py}}


Cleans the plaintiff names and counts frequency of occurance.  


\doxysubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \mbox{\hyperlink{namespacecleanPlaintiffs}{clean\+Plaintiffs}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{namespacecleanPlaintiffs_a171a230e7ac7699beed794eeeba8bf95}{clean\+Plaintiffs.\+get\+\_\+class\+\_\+that\+\_\+defined\+\_\+method}} (meth)
\begin{DoxyCompactList}\small\item\em from \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacecleanPlaintiffs_a0eb434aa5d35772dde9c7944d92a1030}{clean\+Plaintiffs.\+clean\+Plaintiff}} (full\+Plaintiff)
\begin{DoxyCompactList}\small\item\em Removes everything from LLC or comma to the end of the name. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacecleanPlaintiffs_a27eb4357cf84539049992715d5187128}{clean\+Plaintiffs.\+similar\+Name\+List}} (test\+Name, match\+List, compare\+\_\+function, cutoff=90, n\+Returned=50)
\begin{DoxyCompactList}\small\item\em Returns a list of names similar to test\+Name from the match\+List whose match value is $>$= cutoff and returns no more than n\+Returned matches. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacecleanPlaintiffs_adda46272dbe4ad37a680fd5646edd41d}{clean\+Plaintiffs.\+test\+Comparison\+Method}} (series\+To\+Test, test\+Function, number\+To\+Try)
\begin{DoxyCompactList}\small\item\em Runs a test on a comparison method to estimate the total time required to run it on the full dataset. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacecleanPlaintiffs_acef3ec054670e0fcc017786ec1e8aeeb}{clean\+Plaintiffs.\+create\+Similarity\+Matrix}} (cleaned\+Value\+Counts)
\begin{DoxyCompactList}\small\item\em Taking the cleaned\+Value\+Count from plaintiff\+List, this function creates a similarity matrix between the cleaned names. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacecleanPlaintiffs_ac95f78e00ae5ea7f5d4f292d6880844e}{clean\+Plaintiffs.\+plaintiff\+List}} (df, field\+Name)
\begin{DoxyCompactList}\small\item\em Returns df with added column of cleaned plaintiff names. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacecleanPlaintiffs_a948656ff65ed15ab0295c64a3a2b2311}{clean\+Plaintiffs.\+dbscan\+Fit}} (fname, eps, min\+\_\+samples=2)
\begin{DoxyCompactList}\small\item\em Runs DBSCAN clustering on the similarity matrix in fname with epsilon (eps) set to eps and clusters requiring at least min\+\_\+samples in them. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacecleanPlaintiffs_aa52ac5b007acdb249f0fe759a98fa1de}{clean\+Plaintiffs.\+find\+Base\+Names}} (fname, cutoff=0.\+9)
\begin{DoxyCompactList}\small\item\em Finds the base name of each cleaned name This method does not work as of 2021 May 12. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacecleanPlaintiffs_ae505e4677480e7908bdd4bcb9c50bf19}{clean\+Plaintiffs.\+main}} ()
\begin{DoxyCompactList}\small\item\em This is the main function that reads in a csv file containing the court data from the filename passed as the first command line argument. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacecleanPlaintiffs_a5ad72ac922195745aebb519e49a2e29a}{clean\+Plaintiffs.\+cleanco\+\_\+terms}} = prepare\+\_\+terms()
\item 
list \mbox{\hyperlink{namespacecleanPlaintiffs_aea67d0a19052e0460fa4e622f0d7c759}{clean\+Plaintiffs.\+stopwords}} = \mbox{[}\textquotesingle{}a\textquotesingle{}, \textquotesingle{}an\textquotesingle{}, \textquotesingle{}the\textquotesingle{}, \textquotesingle{}are\textquotesingle{}\mbox{]}
\item 
\mbox{\hyperlink{namespacecleanPlaintiffs_ac63f3c02b3a437acefd06b2a74572edd}{clean\+Plaintiffs.\+llc\+Match}} = re.\+compile(r\textquotesingle{}(llc$\vert$,$\vert$a/s/o$\vert$as subrogee of$\vert$\textbackslash{}saso\textbackslash{}s).$\ast$\textquotesingle{}, re.\+I)
\begin{DoxyCompactList}\small\item\em match up to case insensitive first LLC or first comma \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacecleanPlaintiffs_a6b8aa5b6928db0f01e2477455b672597}{clean\+Plaintiffs.\+alpha\+Match}} = re.\+compile(r\textquotesingle{}\mbox{[}$^\wedge$a-\/z A-\/Z0-\/9\mbox{]}\textquotesingle{})
\begin{DoxyCompactList}\small\item\em clean all non-\/alpha and space characters out \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacecleanPlaintiffs_a55df444f6d816fd4a2beebcc6b097a29}{clean\+Plaintiffs.\+end\+Caps}} = re.\+compile(r\textquotesingle{}(\textbackslash{}b(?\+:\mbox{[}A-\/Z\mbox{]}+)\textbackslash{}b(?\+:\textbackslash{}s\mbox{[}A-\/Z\mbox{]}+\textbackslash{}b)$\ast$\textbackslash{}.$\ast$)\$\textquotesingle{})
\begin{DoxyCompactList}\small\item\em matches all caps words to the end of the line \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacecleanPlaintiffs_a2520fa4be7522d0231ab7ac252d6579b}{clean\+Plaintiffs.\+datetime\+To\+End}} = re.\+compile(r\textquotesingle{}(\textbackslash{}s\textbackslash{}d\{1,2\}/\textbackslash{}d\{1,2\}/\textbackslash{}d\{4\} \textbackslash{}d\{1,2\}\+:\textbackslash{}d\{2\} \mbox{[}AP\mbox{]}M.$\ast$)\$\textquotesingle{})
\begin{DoxyCompactList}\small\item\em matches date and time to end of line in format 07/17/2017 1\+:15 \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Cleans the plaintiff names and counts frequency of occurance. 

The functions in this script can clean plaintiff names and then cluster the names to put similar names together. For instance,
\begin{DoxyItemize}
\item Victoria Fire and Casualty Co. a/s/o Robert Logan
\item Victoria Fire and Casualty Company a/s/o Francisco Mulero both refer to the came plaintiff and should be clustered together.
\end{DoxyItemize}

We did the following to clean the plaintiff names\+:
\begin{DoxyItemize}
\item Removed \char`\"{}a/s/o\char`\"{}, \char`\"{}as subrogee of\char`\"{}, “aso”, commas, and the text that followed those items
\item Removed any non-\/alphanumeric characters
\item Used Clean\+Co to remove LLC, INC, etc.
\item Put the names into all uppercase
\end{DoxyItemize}

Clustering plaintiffs is started by using the \href{https://github.com/jamesturk/jellyfish}{\texttt{ jellyfish}} jaro\+\_\+similarity function as can be seen in the \mbox{\hyperlink{namespacecleanPlaintiffs_acef3ec054670e0fcc017786ec1e8aeeb}{create\+Similarity\+Matrix()}} function to calculate similarities between all the cleaned plaintiff names. Once the similarity matrix has been created, the \href{https://towardsdatascience.com/dbscan-algorithm-complete-guide-and-application-with-python-scikit-learn-d690cbae4c5d}{\texttt{ DBSCAN}} algorithm is used to cluster similar names.

Typical use cases are as follows\+: \begin{DoxyVerb}python .\src\cleanPlaintiffs.py ..\data\MC_specialreport_limiteddaterange_Nov6.csv -s
python .\src\cleanPlaintiffs.py ..\data\MC_specialreport_limiteddaterange_Nov6.csv -p .\src\20215121490-comparisonMatrix.pkl
\end{DoxyVerb}
 The first creates the similarity matrix (may take 9 minutes). The second uses this similarity matrix to build a plaintiff vs outcome matrix.

\begin{DoxyAuthor}{Author}
Seth Mc\+Neill 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2021 March 11 
\end{DoxyDate}
